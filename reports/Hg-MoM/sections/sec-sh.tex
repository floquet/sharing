% \input{\pSections "sec-sh"}

\section{Spherical Harmonics}

\textbf{Discovery and Origin} \\
Spherical harmonics were first introduced in the 18th century by mathematicians such as \textit{Pierre-Simon Laplace} in the context of solving Laplace's equation in spherical coordinates. They are solutions to the angular part of the Laplace equation and form a complete orthonormal set of functions on the unit sphere.

\textbf{Definition and Properties} \\
The spherical harmonics \( Y_\ell^m(\theta, \phi) \) are complex-valued functions defined on the sphere and are parameterized by two integers: 
\begin{itemize}
    \item \( \ell \): the degree, representing the total number of nodal lines,
    \item \( m \): the order, representing the number of nodal lines that intersect the equator.
\end{itemize}
These functions are expressed as:
\[
Y_\ell^m(\theta, \phi) = \sqrt{\frac{(2\ell + 1)(\ell - |m|)!}{4\pi (\ell + |m|)!}} P_\ell^{|m|}(\cos\theta) e^{im\phi},
\]
where \( P_\ell^m \) are the associated Legendre polynomials, \( \theta \) is the polar angle, and \( \phi \) is the azimuthal angle.

Spherical harmonics satisfy the orthogonality conditions:
\[
\int_{0}^{2\pi} \int_{0}^{\pi} Y_\ell^m(\theta, \phi) Y_{\ell'}^{m'*}(\theta, \phi) \sin\theta \, d\theta \, d\phi = \delta_{\ell\ell'} \delta_{mm'}.
\]

\textbf{Applications} \\
Spherical harmonics are extensively used in physics, engineering, and mathematics, particularly in fields involving spherical domains or symmetry:
\begin{itemize}
    \item \textbf{Quantum Mechanics:} Solutions to the angular part of the Schr√∂dinger equation for atoms.
    \item \textbf{Geophysics and Astrophysics:} Modeling gravitational and magnetic fields, cosmic microwave background radiation, and planetary shape analysis.
    \item \textbf{Signal Processing:} Analysis on spherical data, such as 3D object representations in computer graphics.
    \item \textbf{Partial Differential Equations:} Solutions in spherical coordinate systems.
    \item \textbf{Harmonic Analysis:} Representing functions on the sphere.
\end{itemize}

\textbf{Recent Developments} \\
Recent studies have focused on extensions of spherical harmonics, including generalizations to higher dimensions and applications in machine learning, such as spherical convolutional neural networks for analyzing spherical data.

\textbf{Examples} \\
The spherical harmonics up to degree \( \ell = 2 \) are shown in Table~\ref{tab:spherical_harmonics}.

\begin{table}[h!]
    \centering
    \caption{Spherical harmonics up to degree \( \ell = 3 \).}
    \label{tab:spherical_harmonics_extended}
    \begin{tabular}{clrcl}
        \textbf{Order} & \textbf{Symbol} & \multicolumn{3}{c}{Spherical Harmonic Function} \\[5pt] % Additional space between orders

        0 & \( Y_0^0 \) & \( \phantom{-} \frac{1}{\sqrt{4\pi}} \) & \( 1 \) & \\[5pt]

        1 & \( Y_1^{-1} \) & \( \sqrt{\frac{3}{8\pi}} \) & \( \textcolor{red}{\sin\theta} \) & \( \textcolor{blue}{e^{-i\phi}} \) \\[3pt]
          & \( Y_1^0 \) & \( \phantom{-} \sqrt{\frac{3}{4\pi}} \) & \( \textcolor{red}{\cos\theta} \) & \\[3pt]
          & \( Y_1^1 \) & \( -\sqrt{\frac{3}{8\pi}} \) & \( \textcolor{red}{\sin\theta} \) & \( \textcolor{blue}{e^{i\phi}} \) \\[5pt]

        2 & \( Y_2^{-2} \) & \( \sqrt{\frac{15}{32\pi}} \) & \( \textcolor{red}{\sin^2\theta} \) & \( \textcolor{blue}{e^{-2i\phi}} \) \\[3pt]
          & \( Y_2^{-1} \) & \( \sqrt{\frac{15}{8\pi}} \) & \( \textcolor{red}{\sin(2\theta)} \) & \( \textcolor{blue}{e^{-i\phi}} \) \\[3pt]
          & \( Y_2^0 \) & \( \phantom{-} \sqrt{\frac{5}{16\pi}} \) & \( 3\textcolor{red}{\cos^2\theta} - 1 \) & \\[3pt]
          & \( Y_2^1 \) & \( -\sqrt{\frac{15}{8\pi}} \) & \( \textcolor{red}{\sin(2\theta)} \) & \( \textcolor{blue}{e^{i\phi}} \) \\[3pt]
          & \( Y_2^2 \) & \( \sqrt{\frac{15}{32\pi}} \) & \( \textcolor{red}{\sin^2\theta} \) & \( \textcolor{blue}{e^{2i\phi}} \) \\[5pt]

        3 & \( Y_3^{-3} \) & \( \sqrt{\frac{35}{64\pi}} \) & \( \textcolor{red}{\sin^3\theta} \) & \( \textcolor{blue}{e^{-3i\phi}} \) \\[3pt]
          & \( Y_3^{-2} \) & \( \sqrt{\frac{105}{32\pi}} \) & \( \textcolor{red}{\sin^2\theta \cos\theta} \) & \( \textcolor{blue}{e^{-2i\phi}} \) \\[3pt]
          & \( Y_3^{-1} \) & \( \sqrt{\frac{21}{64\pi}} \) & \( \textcolor{red}{\sin(2\theta) \sin\theta} \) & \( \textcolor{blue}{e^{-i\phi}} \) \\[3pt]
          & \( Y_3^0 \) & \( \phantom{-} \sqrt{\frac{7}{16\pi}} \) & \( 5\textcolor{red}{\cos^3\theta} - 3\textcolor{red}{\cos\theta} \) & \\[3pt]
          & \( Y_3^1 \) & \( -\sqrt{\frac{21}{64\pi}} \) & \( \textcolor{red}{\sin(2\theta) \sin\theta} \) & \( \textcolor{blue}{e^{i\phi}} \) \\[3pt]
          & \( Y_3^2 \) & \( \sqrt{\frac{105}{32\pi}} \) & \( \textcolor{red}{\sin^2\theta \cos\theta} \) & \( \textcolor{blue}{e^{2i\phi}} \) \\[3pt]
          & \( Y_3^3 \) & \( -\sqrt{\frac{35}{64\pi}} \) & \( \textcolor{red}{\sin^3\theta} \) & \( \textcolor{blue}{e^{3i\phi}} \) \\[5pt]

    \end{tabular}
\end{table}

%     %     %     %     %     %     %     %     %
\subsection{Spherical Harmonic Decomposition}

This document provides a detailed procedure to resolve a list of function values \( f(\theta, \phi) \) into amplitudes of spherical harmonic functions \( Y_\ell^m(\theta, \phi) \).

%     %     %     %     %     %     %     %     %
\subsection{Spherical Harmonic Expansion}
The function \( f(\theta, \phi) \) can be expanded as:
\[
f(\theta, \phi) = \sum_{\ell=0}^\infty \sum_{m=-\ell}^\ell a_{\ell m} Y_\ell^m(\theta, \phi),
\]
where the coefficients \( a_{\ell m} \) are computed by:
\[
a_{\ell m} = \int_{0}^{2\pi} \int_{0}^{\pi} f(\theta, \phi) Y_\ell^m(\theta, \phi)^* \sin\theta \, d\theta \, d\phi.
\]

Here, \( Y_\ell^m(\theta, \phi)^* \) is the complex conjugate of the spherical harmonics.

%     %     %     %     %     %     %     %     %
\subsection{Mathematica Code}

%     %     %     %     %     %     %     %     %
\subsubsection{Define the Function}
Define the function \( f(\theta, \phi) \) in Mathematica:
\begin{lstlisting}
(* Function definition *)
f[theta_, phi_] := Sin[theta] * Cos[phi]
\end{lstlisting}

%     %     %     %     %     %     %     %     %
\subsubsection{Compute the Coefficients}
The following Mathematica code computes the spherical harmonic coefficients \( a_{\ell m} \) for a given function \( f(\theta, \phi) \) up to a maximum \( \ell \) value:
\begin{lstlisting}
(* Define the maximum value of l for expansion *)
maxL = 5;

(* Create a table of coefficients *)
coefficients = Table[
   NIntegrate[
     f[theta, phi] Conjugate[SphericalHarmonicY[l, m, theta, phi]] Sin[theta],
     {theta, 0, Pi}, {phi, 0, 2 Pi}
   ],
   {l, 0, maxL}, {m, -l, l}
];
\end{lstlisting}

%     %     %     %     %     %     %     %     %
\subsubsection{Reconstruct the Function}
The reconstructed function is computed as:
\begin{lstlisting}
(* Reconstruct the function *)
reconstructedF[theta_, phi_] := Sum[
  coefficients[[l + 1, m + l + 1]] SphericalHarmonicY[l, m, theta, phi],
  {l, 0, maxL}, {m, -l, l}
];
\end{lstlisting}

%     %     %     %     %     %     %     %     %
\subsubsection{Visualization}
Compare the original and reconstructed functions using plots:
\begin{lstlisting}
(* Plot original function *)
SphericalPlot3D[Abs[f[theta, phi]], {theta, 0, Pi}, {phi, 0, 2 Pi}]

(* Plot reconstructed function *)
SphericalPlot3D[Abs[reconstructedF[theta, phi]], {theta, 0, Pi}, {phi, 0, 2 Pi}]
\end{lstlisting}

%     %     %     %     %     %     %     %     %
\subsection{Notes}
\begin{itemize}
    \item Ensure the resolution of the \( \theta \) and \( \phi \) sampling is sufficient for accurate representation.
    \item The numerical integration step (\texttt{NIntegrate}) can be adjusted for higher precision if required.
\end{itemize}

\subsection*{Least Squares}

The goal of this subsection is to find the amplitudes $a_{\ell m}$ of the spherical harmonic expansion that best approximate the function $f(\theta, \phi)$ sampled at $N$ discrete points. 

%     %     %     %     %     %     %     %     %
\subsubsection*{Spherical Harmonic Expansion}
The spherical harmonic expansion of the function $f(\theta, \phi)$ is:
\[
f(\theta, \phi) \approx \sum_{\ell=0}^{L_{\text{max}}} \sum_{m=-\ell}^\ell a_{\ell m} Y_\ell^m(\theta, \phi),
\]
where $Y_\ell^m(\theta, \phi)$ are the spherical harmonics and $a_{\ell m}$ are the expansion coefficients.

\subsubsection*{Discrete Sampling}
Assuming the function $f(\theta, \phi)$ is sampled at $N$ discrete points $(\theta_i, \phi_i)$, we denote the sampled values as $f_i = f(\theta_i, \phi_i)$ for $i = 1, 2, \dots, N$. At these sampled points, the spherical harmonic expansion becomes:
\[
f_i \approx \sum_{\ell=0}^{L_{\text{max}}} \sum_{m=-\ell}^\ell a_{\ell m} Y_\ell^m(\theta_i, \phi_i), \quad i = 1, 2, \dots, N.
\]

%     %     %     %     %     %     %     %     %
\subsubsection*{Matrix Formulation}
The system of equations can be expressed in matrix form:
\[
\mathbf{f} \approx \mathbf{Y} \mathbf{a},
\]
where:
\begin{itemize}
    \item $\mathbf{f} \in \mathbb{R}^N$ is the vector of sampled function values:
    \[
    \mathbf{f} = [f_1, f_2, \dots, f_N]^\top,
    \]
    \item $\mathbf{a} \in \mathbb{R}^M$ is the vector of unknown coefficients:
    \[
    \mathbf{a} = [a_{00}, a_{1,-1}, a_{10}, a_{11}, \dots, a_{L_{\text{max}},L_{\text{max}}}]^\top,
    \]
    where $M = (L_{\text{max}}+1)^2$ is the total number of coefficients,
    \item $\mathbf{Y} \in \mathbb{R}^{N \times M}$ is the design matrix:
    \[
    Y_{ij} = Y_\ell^m(\theta_i, \phi_i),
    \]
    where $j$ indexes the pair $(\ell, m)$ in lexicographic order.
\end{itemize}

%     %     %     %     %     %     %     %     %
\subsubsection*{Least Squares Solution}
To find the best-fit coefficients $\mathbf{a}$, we minimize the residual:
\[
\|\mathbf{f} - \mathbf{Y} \mathbf{a}\|^2.
\]
The least-squares solution is obtained by solving the normal equations:
\[
\mathbf{Y}^\top \mathbf{Y} \mathbf{a} = \mathbf{Y}^\top \mathbf{f}.
\]

%     %     %     %     %     %     %     %     %
\subsubsection*{Key Components of the Linear System}
\begin{enumerate}
    \item **Matrix $\mathbf{Y}$:**
    \begin{itemize}
        \item Rows correspond to the sampled points $(\theta_i, \phi_i)$.
        \item Columns correspond to the spherical harmonics $Y_\ell^m(\theta, \phi)$ for each $(\ell, m)$.
    \end{itemize}
    \item **Vector $\mathbf{a}$:**
    \begin{itemize}
        \item Contains the amplitudes $a_{\ell m}$ of the spherical harmonic expansion.
    \end{itemize}
    \item **Vector $\mathbf{f}$:**
    \begin{itemize}
        \item Contains the sampled function values $f_i$.
    \end{itemize}
\end{enumerate}

%     %     %     %     %     %     %     %     %
\subsubsection*{Summary}
The least squares fit constructs a linear system:
\[
\mathbf{Y}^\top \mathbf{Y} \mathbf{a} = \mathbf{Y}^\top \mathbf{f}.
\]
Solving this system yields the amplitudes $a_{\ell m}$ that approximate the function $f(\theta, \phi)$ in terms of spherical harmonics.

\subsection{Vector formulation}

Let \( \mathbf{a} \) represent the vector of amplitudes and \( \mathbf{b}(\theta, \phi) \) denote the vector of basis functions evaluated at a given point \( (\theta, \phi) \). The function \( f(\theta, \phi) \) is approximated as the dot product of these two vectors:
\[
f(\theta, \phi) \approx \mathbf{a} \cdot \mathbf{b}(\theta, \phi).
\]

%     %     %     %     %     %     %     %     %
\subsubsection*{Components}
\begin{itemize}
    \item \textbf{Vector of Amplitudes (\( \mathbf{a} \)):}
    \[
    \mathbf{a} = [a_{00}, a_{1,-1}, a_{10}, a_{11}, \dots, a_{L_{\text{max}},L_{\text{max}}}]^\top,
    \]
    where \( a_{\ell m} \) are the coefficients of the spherical harmonic expansion.

    \item \textbf{Vector of Basis Functions (\( \mathbf{b}(\theta, \phi) \)):}
    \[
    \mathbf{b}(\theta, \phi) = [Y_0^0(\theta, \phi), Y_1^{-1}(\theta, \phi), Y_1^0(\theta, \phi), Y_1^1(\theta, \phi), \dots, Y_{L_{\text{max}}}^{L_{\text{max}}}(\theta, \phi)]^\top,
    \]
    where \( Y_\ell^m(\theta, \phi) \) are the spherical harmonics.

    \item \textbf{Approximation Function (\( f(\theta, \phi) \)):}
    The approximation of \( f(\theta, \phi) \) is expressed as:
    \[
    f(\theta, \phi) \approx \mathbf{a} \cdot \mathbf{b}(\theta, \phi) = \sum_{\ell=0}^{L_{\text{max}}} \sum_{m=-\ell}^\ell a_{\ell m} Y_\ell^m(\theta, \phi).
    \]
\end{itemize}

%     %     %     %     %     %     %     %     %
\subsubsection*{Discrete Sampling}
For \( N \) discrete sampled points \( (\theta_i, \phi_i) \), the function values \( f_i = f(\theta_i, \phi_i) \) can be written as:
\[
f_i \approx \mathbf{a} \cdot \mathbf{b}(\theta_i, \phi_i), \quad i = 1, 2, \dots, N.
\]
This yields the linear system:
\[
\mathbf{f} \approx \mathbf{B} \mathbf{a},
\]
where:
\begin{itemize}
    \item \( \mathbf{f} = [f_1, f_2, \dots, f_N]^\top \) is the vector of sampled function values.
    \item \( \mathbf{B} \in \mathbb{R}^{N \times M} \) is the matrix of basis functions, with:
    \[
    \mathbf{B}_{ij} = b_j(\theta_i, \phi_i) = Y_\ell^m(\theta_i, \phi_i),
    \]
    where \( j \) indexes the basis functions \( Y_\ell^m \).
    \item \( \mathbf{a} \) is the vector of amplitudes as defined earlier.
\end{itemize}

%     %     %     %     %     %     %     %     %
\subsubsection*{Least Squares Solution}
To determine \( \mathbf{a} \), the squared residual is minimized:
\[
\|\mathbf{f} - \mathbf{B} \mathbf{a}\|^2.
\]
The least squares solution is given by:
\[
\mathbf{a} = (\mathbf{B}^\top \mathbf{B})^{-1} \mathbf{B}^\top \mathbf{f}.
\]

%     %     %     %     %     %     %     %     %
\subsubsection*{Interpretation}
\begin{itemize}
    \item The rows of \( \mathbf{B} \) correspond to the sampled points \( (\theta_i, \phi_i) \).
    \item The columns of \( \mathbf{B} \) correspond to the spherical harmonic basis functions \( Y_\ell^m(\theta, \phi) \).
    \item The vector \( \mathbf{a} \) contains the amplitudes \( a_{\ell m} \) that weight the contribution of each basis function.
\end{itemize}

\endinput  %  ==  ==  ==  ==  ==  ==  ==  ==  ==